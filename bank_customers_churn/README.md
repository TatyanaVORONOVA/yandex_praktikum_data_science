# Построение модели для прогнозирования ухода клиентов из банка

## Статус проекта: 
завершен

## Ключевые слова проекта: 
- классификация
- подбор гиперпараметров
- балансировка классов
- AUC-ROC

## Вводные данные проекта:

В «Бета-Банке» наблюдается отток клиентов. Нужно спрогнозировать, уйдет клиент из банка в ближайшее время или нет.

**Заказчик:** «Бета-Банка».

**Цель проекта:** построение качественной модели для максимально точного прогнозирования оттока клиентов из банка.

**Дополнительная информация от заказчика:**
- значением метрики F1-меры должна быть не менее 0.59;
- дополнительно измерить AUC-ROC, сравнить её значение с F1-мерой;
- банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.

**Данные для анализа и построения модели:** исторические данные о поведении клиентов и расторжении договоров с банком. Источник данных: https://www.kaggle.com/barelydedicated/bank-customer-churn-modeling

**Этапы проекта:**
- Загрузить данные, изучить общую информацию об имеющихся данных.
- Подготовить данные.
- Исследовать баланс классов, обучить модель без учёта дисбаланса.
- Улучшить качество модели, учитывая дисбаланс классов.
- Обучить разные модели и найти лучшую.
- Провести финальное тестирование.

## Используемые библиотеки:
- pandas
- numpy
- matplotlib
- seaborn
- sklearn

## Выводы по проекту
В ходе проекта были **реализованы следующие этапы:**
- Загружены данные и проведен исследовательский анализ - датасет не имеет существенных выбросов, аномалий, пропусков и дубликатов. При выводе изображений на экран видим, что фото соответствуют указанному в метках возрасту.
- Обучена модель с архитектурой ResNet50 с достижением целевого результата MAE ниже 8 (5.8).

**Выводы по результатам проекта:**

Итоговые метрики качества на тестовой выборке
 |           |  precision|    recall | f1-score|   support|
| :-------- | :----------- | :--------- | :-------- |:-------- |
 |          0  |     0.91   |   0.88   |   0.89 |     1536|
  |         1  |     0.58   |   0.65   |   0.62   |    390|
|                                                         |
 |   accuracy |            |            |  0.83   |   1926|
 |  macro avg  |     0.75   |   0.77    |  0.76   |   1926|
|weighted avg   |    0.84  |    0.83  |    0.84  |    1926|

------------------------------------------------------
Метрика AUC-ROC на тестовой выборке RandomForestClassifier (balanced): 0.85

С помощью ручной корректировки баланса классов удалось достичь значения recall - 0.65 и f1 - 0.62.

**Параметры лучшей модели:**

clf = RandomForestClassifier(random_state=12345, max_depth=9, min_samples_leaf=1, min_samples_split=3, n_estimators=22, class_weight={0:0.2, 1:0.8}) 
